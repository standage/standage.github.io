<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Daniel Standage</title>
	<meta name="description" content="">
	<meta name="author" content="Daniel S. Standage">

	<!-- HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
		<script src="https://standage.github.io/theme/html5.js"></script>
	<![endif]-->

	<!-- Styles -->
	<link href="https://standage.github.io/theme/bootstrap.min.css" rel="stylesheet">
	<link href="https://standage.github.io/theme/local.css" rel="stylesheet">
	<link href="https://standage.github.io/theme/pygments.css" rel="stylesheet">

	<!-- Feeds -->
	<link href="https://standage.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Daniel Standage Atom Feed" />


	<link href="https://standage.github.io/feed.xml" type="application/rss+xml" rel="alternate" title="Daniel Standage RSS Feed" />


<script type="text/javascript">
	var disqus_identifier = "filter-stderr-while-piping-in-unix.html";
	(function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = 'https://standage-github-io.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
</head>
<body>
	<div class="topbar">
	  <div class="topbar-inner">
		<div class="container-fluid">
		  <a class="brand" href="https://standage.github.io/">Daniel Standage</a>
			<ul class="nav">
						<li><a href="https://standage.github.io/pages/vitae.html">Vitae</a></li>
						<li><a href="https://standage.github.io/pages/teaching.html">Teaching</a></li>
						<li><a href="https://standage.github.io/pages/software-databases.html">Software & Databases</a></li>
				<li><a href="https://standage.github.io/notebook.html">Notebook</a></li>
			</ul>
			<p class="pull-right"><a href="https://standage.github.io/archives.html">[archives]</a> <a href="https://standage.github.io/categories.html">[categories]</a> <a href="https://standage.github.io/tags.html">[tags]</a></p>
		</div>
	  </div>
	</div>

	<div class="container-fluid">
	  <div class="sidebar">
		<div class="well">
			<img src="http://1.gravatar.com/avatar/fe326141c425326acf247aef9c475c03?size=180" alt="Daniel Standage" />
			<h3>Daniel S. Standage</h3>
			<p>
				205A Simon Hall<br />
				Indiana University<br />
				212 South Hawthorne Drive<br />
				Bloomington, IN 47405<br />
			</p>
			<h3>Affiliations</h3>
			<ul>
				<li><a href="http://brendelgroup.org/">Brendel Group</a></li>
				<li><a href="http://www.public.iastate.edu/~amytoth/Toth_lab/Home.html">Toth Lab</a></li>
				<li><a href="http://www.bio.indiana.edu/">Indiana Biology Department</a></li>
				<li><a href="http://www.bcb.iastate.edu/">Iowa State BCB Program</a></li>
			</ul>
			<div class="social">
			<h3>Social</h3>
			<ul>
				<li><a href="http://github.com/standage">GitHub</a></li>
				<li><a href="https://twitter.com/byuhobbes">Twitter</a></li>
				<li><a href="http://stackexchange.com/users/208980/daniel-standage?tab=accounts">StackExchange</a></li>
			</ul>
			</div>
		</div>
	  </div>
	  <div class="content">
	<div class='article'>
		<div class="page-header"><h1>Filter stderr while piping in UNIX</h1></div>
		<div class="well small">Permalink: <a class="more" href="https://standage.github.io/filter-stderr-while-piping-in-unix.html">2015-12-14</a>
by <a class="url fn" href="https://standage.github.io/author/daniel-s-standage.html">Daniel S. Standage </a>
 in <a href="https://standage.github.io/category/noteboop.html">noteboop</a>
tags: <a href="https://standage.github.io/tag/shell.html">shell</a> </div>
		<div><p>I've written before about <a href="https://biowize.wordpress.com/2013/10/11/commands-in-place-of-program-arguments/">process substitutions in the shell</a>.
This has become a core technique I use almost on a daily basis in my data work in the shell.
It has many uses, but I want to highlight a particular one here.</p>
<h2>Use case</h2>
<p>Imagine you have a shell script with the following commands</p>
<div class="highlight"><pre>first_command --arg1<span class="o">=</span>foo --arg2<span class="o">=</span>bar --flag3 infile.txt <span class="se">\</span>
    <span class="p">|</span> second_command one two three <span class="se">\</span>
    <span class="p">|</span> third_command --abc xyz <span class="se">\</span>
    &gt; outfile.txt
</pre></div>


<p>Each of these commands will print to stderr in case of a warning or an error.
However, <code>second_command</code> prints an irrelevant warning (<code>cannot find "foo"</code>) message over and over again, filling up the terminal with thousands of lines of noise and making it more difficult to find warnings or error messages we might actually care about.
How can we filter the stderr of <code>second_command</code> so that the <code>cannot find "foo"</code> messages are ignored, but all other messages still show up?</p>
<h2>Solution</h2>
<p>Process substitutions can be used not only as pseudo input files using the <code>&lt;()</code> syntax, but also as pseudo output files using the <code>&gt;()</code> syntax.
If we redirect a program's output to a process, we can then filter the data within that process, like so.</p>
<div class="highlight"><pre>some_program &gt; &gt;<span class="o">(</span>sort <span class="p">|</span> uniq -c<span class="o">)</span>
</pre></div>


<p>Extending this to stderr requires only two changes.
First, we replace <code>&gt;</code> with <code>2&gt;</code> so that we are redirecting the correct output stream.</p>
<div class="highlight"><pre>some_program 2&gt; &gt;<span class="o">(</span>sort <span class="p">|</span> uniq -c<span class="o">)</span>
</pre></div>


<p>Secondly, we add <code>1&gt;&amp;2</code> to the end of the process so that its stdout is redirected back to stderr, which is where the data was intended to go in the first place (cue Ghostbusters quote about not crossing the streams).</p>
<div class="highlight"><pre>some_program 2&gt; &gt;<span class="o">(</span>sort <span class="p">|</span> uniq -c 1&gt;<span class="p">&amp;</span>2<span class="o">)</span>
</pre></div>


<p>Putting this all together and going back to our original use case, we can remove the unwanted <code>cannot find "foo"</code> messages from our terminal like so.</p>
<div class="highlight"><pre>first_command --arg1<span class="o">=</span>foo --arg2<span class="o">=</span>bar --flag3 infile.txt <span class="se">\</span>
    <span class="p">|</span> second_command one two three 2&gt; &gt;<span class="o">(</span>grep <span class="s1">&#39;cannot find &quot;foo&quot;&#39;</span> 1&gt;<span class="p">&amp;</span>2<span class="o">)</span> <span class="se">\</span>
    <span class="p">|</span> third_command --abc xyz <span class="se">\</span>
    &gt; outfile.txt
</pre></div>


<p>That's it!</p></div>
		<div>
			<h2>Comments</h2>
<div id="disqus_thread"></div>		<div>
	</div>
		<footer>
		  <p>
			<a href="http://creativecommons.org/licenses/by/4.0/"><img src="https://standage.github.io/images/cc-by-88x31.png" alt="CC BY 4.0" /></a><br />
		    &copy; 2015 Daniel S. Standage.<br />
			Unless otherwise noted, all content on this site is posted under a <a href="http://creativecommons.org/licenses/by/4.0/">CC BY license</a>.</p>
		  <p></p>
		  <p>This site is powered by <a href="http://getpelican.com/">Pelican</a>, its theme based on <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap</a>.</p>
		</footer>
	  </div>

	</div>
</body>
</html>