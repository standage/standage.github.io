<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Daniel S. Standage</title>
	<meta name="description" content="">
	<meta name="author" content="Daniel S. Standage">

	<!-- HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
		<script src="https://standage.github.io/theme/html5.js"></script>
	<![endif]-->

	<!-- Styles -->
	<link href="https://standage.github.io/theme/bootstrap.min.css" rel="stylesheet">
	<link href="https://standage.github.io/theme/local.css" rel="stylesheet">
	<link href="https://standage.github.io/theme/pygments.css" rel="stylesheet">

	<!-- Feeds -->
	<link href="https://standage.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Daniel S. Standage Atom Feed" />


	<link href="https://standage.github.io/feed.xml" type="application/rss+xml" rel="alternate" title="Daniel S. Standage RSS Feed" />


<script type="text/javascript">
	var disqus_identifier = "formatting-c-code-with-clang-format.html";
	(function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = 'https://standage-github-io.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
</head>
<body>
	<div class="topbar">
	  <div class="topbar-inner">
		<div class="container-fluid">
		  <a class="brand" href="https://standage.github.io/">Daniel S. Standage</a>
			<ul class="nav">
				<li><a href="https://scholar.google.com/citations?user=OohLwhsAAAAJ&hl=en">Publications</a></li>
				<li><a href="https://github.com/standage">Github</a></li>
				<li><a href="https://twitter.com/byuhobbes">@byuhobbes</a></li>
				<li><a href="https://standage.github.io/notebook.html">Notebook</a></li>
			</ul>
			<p class="pull-right">
				<a href="https://standage.github.io/archives.html">[archives]</a>
				<a href="https://standage.github.io/categories.html">[categories]</a>
				<a href="https://standage.github.io/tags.html">[tags]</a>
			</p>
		</div>
	  </div>
	</div>

	<div class="container-fluid">
	  <div class="sidebar">
		<div class="well">
			<img src="https://www.gravatar.com/avatar/55b2cca3b7a11df3a961d57a68705503?size=180" alt="Daniel Standage" />
			<h3>Daniel S. Standage</h3>
			<p>
				Principal Investigator<br />
				Bioinformatics<br />
				National Bioforensic Analysis Center (NBFAC)<br />
			</p>
			<!--<h3>Affiliations</h3>
			<ul>
				<li><a href="http://ivory.idyll.org/lab/">Lab for Data Intensive Biology</a></li>
				<li><a href="http://brendelgroup.org/">Brendel Group</a></li>
				<li><a href="http://www.public.iastate.edu/~amytoth/Toth_lab/Home.html">Toth Lab</a></li>
			</ul>
			<div class="social">
			<h3>Social</h3>
			<ul>
				<li><a href="http://github.com/standage">GitHub</a></li>
				<li><a href="https://twitter.com/byuhobbes">Twitter</a></li>
				<li><a href="http://stackexchange.com/users/208980/daniel-standage?tab=accounts">StackExchange</a></li>
			</ul>
			</div>-->
		</div>
	  </div>
	  <div class="content">
	<div class='article'>
		<div class="page-header"><h1>Formatting C code with clang-format</h1></div>
		<div class="well small">Permalink: <a class="more" href="https://standage.github.io/formatting-c-code-with-clang-format.html">2016-01-19</a>
by <a class="url fn" href="https://standage.github.io/author/daniel-s-standage.html">Daniel S. Standage </a>
 in <a href="https://standage.github.io/category/blog.html">blog</a>
tags: <a href="https://standage.github.io/tag/programming.html">programming</a> <a href="https://standage.github.io/tag/c.html">c</a> </div>
		<div><p>Code formatting styles: the thing we all love to hate.</p>
<p><img alt="The rules are like guidelines anyway" src="https://standage.github.io/images/pirate-guidelines.gif"></p>
<p>The best formatting style is the style you don't have to think about, the style that helps you focus on the logical flow of your code.
The best formatting style is consistent and organic, providing an intuitive visual representation of program organization.</p>
<p>On the other hand, pedantic enforcement formatting styles can outweigh any benefits you get from it in the first place.</p>
<p>A lot of digital ink has been spilled and flame wars fought over this topic, and I will not belabor the point here.
Suffice it to say that I think that enforcement of code formatting style is, on the whole, a good thing.
Styles focus mostly on readability, which is a HUGE DEAL when it comes to collaborative development and maintenance of code.
Simplifying the <em>maintenance</em> of your code will save much more of your time and others' time in the future than almost any technical optimization.
Explicitly enforcing a style convention (like Python's PEP8, and associated tools <code>pep8</code> and <code>autopep8</code>) minimize conflicts between project contributors, and make it easier to integrate contributions from new contributors.
Exceptions can be considered on a per-case basis, and most enforcement tools provide mechanisms for marking code to ignore, but for the most part the rules are there to be followed for everyone's benefit.</p>
<p>For Python programming, the PEP8 style is the uncontested standard.
There may be others out there, but they're surely obscure and <em>ad hoc</em>.
When it comes to C and C++, however, there are many different popular styles.
There are lots of commonalities, but the differences (particularly in the placement of braces) make a huge difference in the appearance of the code.
I prefer the popular Allman style, the K&amp;R style (also popular) is pretty reasonable, but styles like Whitesmith and Pico are just nuts!
See <a href="http://www.terminally-incoherent.com/blog/2009/04/10/the-only-correct-indent-style/">this page</a> for some examples.</p>
<p>So in some <a href="https://matt.sh/howto-c">recent reading</a> I came across a tool called <code>clang-format</code> that will automatically format C code based on your preferred style.
All of my C code formatting has previously been self-enforced, but after using <code>pep8</code> and <code>autopep8</code> on my Python code for a few years now I thought it was time to let an automated tool do the work for me.
Here's my config file (<code>.clang-format</code>).</p>
<div class="highlight"><pre><span></span><code><span class="n">BasedOnStyle</span><span class="o">:</span><span class="w"> </span><span class="n">llvm</span><span class="w"></span>
<span class="n">IndentWidth</span><span class="o">:</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="n">AllowShortFunctionsOnASingleLine</span><span class="o">:</span><span class="w"> </span><span class="n">None</span><span class="w"></span>
<span class="n">KeepEmptyLinesAtTheStartOfBlocks</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="w"></span>
<span class="n">BreakBeforeBraces</span><span class="o">:</span><span class="w"> </span><span class="n">Allman</span><span class="w"></span>
</code></pre></div>

<p>And here's the command I use to reformat a file.</p>
<div class="highlight"><pre><span></span><code>clang-format -i -style=file src/locuspocus.c
</code></pre></div>

<p>Credits.</p>
<ul>
<li><a href="https://matt.sh/howto-c">This post</a> got me going on this.</li>
<li><a href="http://stackoverflow.com/questions/29477654/how-to-make-clang-format-add-new-line-before-opening-brace-of-a-function">This thread</a> was helpful</li>
<li><a href="http://clang.llvm.org/docs/ClangFormatStyleOptions.html">This page</a> has the official documentation.</li>
<li><a href="http://stackoverflow.com/questions/25880990/clang-format-breaks-lint-annotations">This answer</a> describes a nice trick for disabling style checks for a code block.</li>
</ul></div>
		<div>
			<h2>Comments</h2>
<div id="disqus_thread"></div>		<div>
	</div>
		<footer>
		  <p>
			<a href="http://creativecommons.org/licenses/by/4.0/"><img src="https://standage.github.io/images/cc-by-88x31.png" alt="CC BY 4.0" /></a><br />
		    &copy; 2015-2022 Daniel S. Standage.<br />
			Unless otherwise noted, all content on this site is posted under a <a href="http://creativecommons.org/licenses/by/4.0/">CC BY license</a>.</p>
		  <p></p>
		  <p>This site is powered by <a href="http://getpelican.com/">Pelican</a>, its theme based on <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap</a>.</p>
		</footer>
	  </div>

	</div>
</body>
</html>